<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flor M치gica</title>
<link href="https://fonts.googleapis.com/css2?family=Courgette&family=Gravitas+One&display=swap" rel="stylesheet">
<style>
  body { margin:0; overflow:hidden; background:black; font-family:'Gravitas One', cursive; }
  canvas { position:absolute; top:0; left:0; }
  #bgCanvas { z-index:0; }
  #flowerCanvas { z-index:1; }
  #startButton {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    font-family:'Gravitas One', cursive; font-size:26px; padding:15px 25px;
    cursor:pointer; border:none; border-radius:20px;
    background:linear-gradient(45deg,#ffea5c,#ffc107); color:black;
    z-index:5; box-shadow:0 5px 15px rgba(0,0,0,0.3);
    transition: transform 0.2s, box-shadow 0.2s;
  }
  #startButton:hover { transform:translate(-50%,-50%) scale(1.1); box-shadow:0 10px 20px rgba(255,255,0,0.6); }
  #message {
    position:absolute; bottom:120px; width:100%; text-align:center;
    font-family:'Courgette', cursive; font-size:28px; color:#ffb6c1;
    opacity:0; z-index:4;
    text-shadow:0 0 3px #ffb6c1,0 0 6px #ff69b4,0 0 10px #ff69b4;
  }
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>
<canvas id="flowerCanvas"></canvas>
<button id="startButton">Para la m치s hermosa 游눝</button>
<div id="message">Gracias a Dios por ponerte en mi camino 游눙</div>

<!-- Audios locales -->
<audio id="bgMusic" src="bg.mp3" loop preload="auto"></audio>
<audio id="clickSound" src="click.mp3" preload="auto"></audio>
<audio id="flowerSound" src="flower.mp3" preload="auto"></audio>

<script>
const bgCanvas = document.getElementById('bgCanvas');
const bgCtx = bgCanvas.getContext('2d');
const flowerCanvas = document.getElementById('flowerCanvas');
const ctx = flowerCanvas.getContext('2d');
bgCanvas.width = flowerCanvas.width = window.innerWidth;
bgCanvas.height = flowerCanvas.height = window.innerHeight;

const center = { x: flowerCanvas.width/2, y: flowerCanvas.height/2 };
const petalsCount = 8;
const petalLength = 150;
const petalWidth = 50;
const centerRadius = 30;
let angleOffset = 0;
let showFlower = false;
let entryProgress = 0;

// Estrellas y polvo
const stars = Array.from({length:100}, ()=>({x:Math.random()*bgCanvas.width, y:Math.random()*bgCanvas.height, r:Math.random()*2+0.5, speed:Math.random()*0.5+0.1, brightness:Math.random()*0.6+0.4}));
const dust = Array.from({length:50}, ()=>({x:center.x+(Math.random()-0.5)*100, y:center.y+(Math.random()-0.5)*100, r:Math.random()*2+0.5, alpha:Math.random(), speed:Math.random()*0.5+0.2}));

// Corazones cayendo
const hearts = Array.from({length:50}, ()=>({x:Math.random()*flowerCanvas.width, y:Math.random()*-flowerCanvas.height, size:Math.random()*8+3, speed:Math.random()*1+0.5, color:`hsl(${Math.random()*360},70%,70%)`}));
// Brillos del bot칩n
let buttonGlows = [];

// ---- Funciones fondo ----
function drawStars(){
  stars.forEach(s=>{
    const react = showFlower ? 0.2*Math.sin(Date.now()/300) : 0;
    bgCtx.fillStyle = `rgba(255,255,255,${s.brightness+react})`;
    bgCtx.beginPath();
    bgCtx.arc(s.x, s.y, s.r,0,Math.PI*2);
    bgCtx.fill();
    s.y += s.speed; if(s.y>bgCanvas.height) s.y=0;
  });
}
function drawDust(){
  dust.forEach(d=>{
    bgCtx.fillStyle = `rgba(255,215,0,${d.alpha})`;
    bgCtx.beginPath();
    bgCtx.arc(d.x,d.y,d.r,0,Math.PI*2);
    bgCtx.fill();
    d.y -= d.speed; d.alpha -= 0.005;
    if(d.alpha<=0){
      d.x=center.x+(Math.random()-0.5)*100;
      d.y=center.y+(Math.random()-0.5)*100;
      d.alpha=Math.random(); d.r=Math.random()*2+0.5; d.speed=Math.random()*0.5+0.2;
    }
  });
}

// ---- Funciones flor ----
function drawHearts(){
  hearts.forEach(h=>{
    ctx.fillStyle=h.color;
    ctx.beginPath();
    ctx.moveTo(h.x,h.y);
    ctx.arc(h.x-h.size/2,h.y,h.size/2,0,Math.PI*2);
    ctx.arc(h.x+h.size/2,h.y,h.size/2,0,Math.PI*2);
    ctx.fill();
    h.y += h.speed;
    if(h.y>flowerCanvas.height){
      h.y=-10; h.x=Math.random()*flowerCanvas.width;
    }
  });
}

function drawButtonGlows(){
  buttonGlows.forEach((g,i)=>{
    ctx.fillStyle = `rgba(255, 223, 0, ${g.alpha})`;
    ctx.beginPath();
    ctx.arc(g.x, g.y, g.r,0,Math.PI*2);
    ctx.fill();
    g.alpha -=0.02; g.r +=1.5;
  });
  buttonGlows = buttonGlows.filter(g=>g.alpha>0);
}

function drawPetal(x,y,angle,scale=1,index=0){
  ctx.save(); ctx.translate(x,y); ctx.rotate(angle+Math.sin(Date.now()/500+angle)*0.1); ctx.scale(scale,scale);
  const glow=0.2+0.1*Math.sin(Date.now()/400+index);
  ctx.shadowBlur=15; ctx.shadowColor=`rgba(255,255,150,${glow})`;
  const grad=ctx.createLinearGradient(0,-petalLength,0,0); grad.addColorStop(0,'#FFD700'); grad.addColorStop(1,'#FFEB3B');
  ctx.fillStyle=grad; ctx.beginPath();
  ctx.moveTo(0,0); ctx.bezierCurveTo(petalWidth/2,-petalLength/2,petalWidth/2,-petalLength,0,-petalLength);
  ctx.bezierCurveTo(-petalWidth/2,-petalLength,-petalWidth/2,-petalLength/2,0,0); ctx.fill();
  ctx.fillStyle=`rgba(255,255,200,${Math.random()*0.05})`; ctx.beginPath();
  ctx.arc(Math.random()*petalWidth-petalWidth/2,-Math.random()*petalLength,1.5,0,Math.PI*2); ctx.fill();
  ctx.restore();
}
function drawCenter(){const grad=ctx.createRadialGradient(center.x,center.y,0,center.x,center.y,centerRadius);grad.addColorStop(0,'#FFD27F');grad.addColorStop(1,'#8B4513');ctx.beginPath();ctx.arc(center.x,center.y,centerRadius,0,Math.PI*2);ctx.fillStyle=grad;ctx.fill();}

// ---- Mensaje ----
let messageVisible=false,messageOpacity=0,messageY=120;

// ---- Animaci칩n ----
function animate(){
  bgCtx.clearRect(0,0,bgCanvas.width,bgCanvas.height);
  drawStars(); drawDust();

  ctx.clearRect(0,0,flowerCanvas.width,flowerCanvas.height);
  drawHearts(); drawButtonGlows();

  if(showFlower){
    if(entryProgress<1){
      for(let i=0;i<petalsCount;i++){
        let angle=(i*2*Math.PI/petalsCount)+angleOffset;
        drawPetal(center.x,center.y,angle,entryProgress,i);
      }
      drawCenter();
      entryProgress+=0.013;
    } else {
      for(let i=0;i<petalsCount;i++){
        let angle=(i*2*Math.PI/petalsCount)+angleOffset;
        drawPetal(center.x,center.y,angle,1,i);
      }
      drawCenter();
      if(!messageVisible){messageVisible=true; document.getElementById('message').style.transition='opacity 3s'; document.getElementById('message').style.opacity=1;}
    }
  }

  angleOffset+=0.002;
  requestAnimationFrame(animate);
}

animate();

// ---- Bot칩n con audio seguro ----
document.getElementById('startButton').addEventListener('click', () => {
  const startBtn = document.getElementById('startButton');
  const bgMusic = document.getElementById('bgMusic');
  const clickSound = document.getElementById('clickSound');
  const flowerSound = document.getElementById('flowerSound');

  bgMusic.volume = 0.5;
  bgMusic.play().catch(()=>console.log("bgMusic bloqueado"));
  clickSound.play().catch(()=>console.log("clickSound bloqueado"));
  flowerSound.play().catch(()=>console.log("flowerSound bloqueado"));

  showFlower = true;
  startBtn.style.display = 'none';
});
</script>
</body>
</html>
